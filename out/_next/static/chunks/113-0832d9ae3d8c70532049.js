"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[113],{5878:function(e,t,n){n.d(t,{Il:function(){return h},t_:function(){return v}});var r=n(2809),a=n(6311),o=n(8715),s=n(374),i=n(7294),u=n(1549),c=n(2503),l=n(5893);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=i.createContext({user:null,token:null}),p=function(e){var t=e.children,n=(0,s._)("auth-token"),r=(0,a.Z)(n,2),d=r[0],f=(r[1],(0,c.ZP)(d?o.PB:null,(function(e){return(0,u.ZP)(e)}))),p=f.data,v=f.error;return(0,i.useEffect)((function(){(p&&!("me"in p)||v&&v.toString().includes("Token not valid"))&&localStorage.removeItem("auth-token")}),[p,v]),(0,l.jsx)(h.Provider,{value:{user:d&&p&&"me"in p?p.me:null,token:d},children:t})},v=function(e){return i.memo((function(t){return(0,l.jsx)(p,{children:(0,l.jsx)(e,f({},t))})}))}},5073:function(e,t,n){var r=n(7294),a=n(5893),o=r.memo((function(e){var t=e.width,n=e.paddingRight,r=e.paddingLeft,o=e.children,s=[];return n&&s.push("padding-right"),r&&s.push("padding-left"),(0,a.jsx)("div",{className:"box width-".concat(t," ").concat(s.join(" ")),children:o})}));t.Z=o},2113:function(e,t,n){n.d(t,{Z:function(){return d}});var r=n(5878),a=n(374),o=n(5073),s=n(9008),i=n(1664),u=n(7294),c=n(5893),l=function(){var e=(0,u.useContext)(r.Il).user,t=(0,a.W)();return(0,c.jsxs)("header",{className:"header",children:[(0,c.jsx)(s.default,{children:(0,c.jsx)("title",{children:"iMovies CA"})}),(0,c.jsx)("div",{className:"container",children:(0,c.jsxs)("div",{className:"flex",children:[(0,c.jsx)(o.Z,{width:"header-small",children:(0,c.jsx)(i.default,{href:"/",children:"iMovies"})}),(0,c.jsx)(o.Z,{width:"header-large",children:(0,c.jsxs)("div",{className:"header-links",children:[t&&(0,c.jsx)(i.default,{href:"/",children:"Issue / Revoke Certificate"}),t&&e&&!1,(0,c.jsx)(i.default,{href:"/revocation-list",children:"Revocation List"}),!t&&(0,c.jsx)(i.default,{href:"/login",children:"Login"}),t&&(0,c.jsx)(i.default,{href:"/logout",children:"Logout"})]})})]})})]})},d=function(e){var t=e.children;return(0,c.jsxs)("div",{children:[(0,c.jsx)(l,{}),(0,c.jsx)("div",{className:"container",children:t})]})}},8715:function(e,t,n){n.d(t,{eK:function(){return r},Nv:function(){return a},PB:function(){return o},LK:function(){return s},D3:function(){return i}});var r="\n  mutation Authenticate($username: String!, $password: String!) {\n    authenticate(username: $username, password: $password) {\n      ... on Session {\n        session_id\n      }\n      ... on AuthenticationException {\n        message\n      }\n    }\n  }\n",a="\n  mutation Logout {\n    logout\n  }\n",o="\n  query {\n    me {\n      username\n      firstname\n      lastname\n      email\n      certificates {\n        id\n        name\n        is_revoked\n        created_at\n        updated_at\n      }\n    }\n  }\n",s="\n  mutation UpdateMe($firstname: String!, $lastname: String!, $email: String!) {\n    updateMe(firstname: $firstname, lastname: $lastname, email: $email) {\n      username\n      firstname\n      lastname\n      email\n      certificates {\n        id\n        name\n        is_revoked\n        created_at\n        updated_at\n      }\n    }\n  }\n",i="\n  mutation UpdatePassword($oldPassword: String!, $newPassword: String!) {\n    updatePassword(oldPassword: $oldPassword, newPassword: $newPassword) {\n      ... on WrongPasswordException {\n        message\n      }\n      ... on User {\n        username\n      }\n    }\n  }\n"},374:function(e,t,n){n.d(t,{_:function(){return s},W:function(){return i}});var r=n(5878),a=n(2957),o=n(7294),s=function(e){return a.C?[localStorage.getItem(e),function(t){return localStorage.setItem(e,t)}]:[null,function(){}]},i=function(){return!!(0,o.useContext)(r.Il).token}},1549:function(e,t,n){n.d(t,{Cq:function(){return x}});var r=n(219),a=n(266),o=n(8216),s=n(5997),i=n(4695),u=n(1077),c=n(268),l=n(2953),d=n(3207),f=n(2809),h=n(809),p=n.n(h),v=n(2957),m=["headers"],y=["headers"];function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){(0,f.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function j(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.Z)(e);if(t){var a=(0,l.Z)(this).constructor;n=Reflect.construct(r,arguments,a)}else n=r.apply(this,arguments);return(0,c.Z)(this,n)}}var b="https://asl-ca.localhost/graphql",x="https://cert.asl-ca.localhost/authentication/tls-cert",O=function(e){(0,u.Z)(n,e);var t=j(n);function n(e,r){var a;(0,o.Z)(this,n);var s="".concat(n.extractMessage(e),": ").concat(JSON.stringify({response:e,request:r}));return a=t.call(this,s),(0,f.Z)((0,i.Z)(a),"response",void 0),(0,f.Z)((0,i.Z)(a),"request",void 0),Object.setPrototypeOf((0,i.Z)(a),n.prototype),a.response=e,a.request=r,"function"===typeof Error.captureStackTrace&&Error.captureStackTrace((0,i.Z)(a),n),a}return(0,s.Z)(n,null,[{key:"extractMessage",value:function(e){try{return e.errors[0].message}catch(t){return"GraphQL Error (Code: ".concat(e.status,")")}}}]),n}((0,d.Z)(Error)),P=function(){function e(t,n){(0,o.Z)(this,e),(0,f.Z)(this,"url",void 0),(0,f.Z)(this,"options",void 0),this.url=t,this.options=n||{}}return(0,s.Z)(e,[{key:"rawRequest",value:function(){var e=(0,a.Z)(p().mark((function e(t,n){var a,o,s,i,u,c,l,d;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.options,o=a.headers,s=(0,r.Z)(a,m),i=JSON.stringify({query:t,variables:n||void 0}),e.next=4,fetch(this.url,w({method:"POST",headers:w({"Content-Type":"application/json"},o),body:i},s));case 4:return u=e.sent,e.next=7,k(u);case 7:if(c=e.sent,!u.ok||c.errors||!c.data){e.next=13;break}return l=u.headers,d=u.status,e.abrupt("return",w(w({},c),{},{headers:l,status:d}));case 13:throw new O(w(w({},"string"===typeof c?{error:c}:c),{},{status:u.status,headers:u.headers}),{query:t,variables:n});case 15:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"request",value:function(){var e=(0,a.Z)(p().mark((function e(t,n){var a,o,s,i,u,c;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=this.options,o=a.headers,s=(0,r.Z)(a,y),i=JSON.stringify({query:t,variables:n||void 0}),e.next=4,fetch(this.url,w({method:"POST",headers:w({"Content-Type":"application/json"},o),body:i},s));case 4:return u=e.sent,e.next=7,k(u);case 7:if(c=e.sent,!u.ok||c.errors||!c.data){e.next=12;break}return e.abrupt("return",c.data);case 12:throw new O(w(w({},"string"===typeof c?{error:c}:c),{},{status:u.status}),{query:t,variables:n});case 14:case"end":return e.stop()}}),e,this)})));return function(t,n){return e.apply(this,arguments)}}()},{key:"setHeaders",value:function(e){return this.options.headers=e,this}},{key:"setHeader",value:function(e,t){var n=this.options.headers;return n?n[e]=t:this.options.headers=(0,f.Z)({},e,t),this}}]),e}();function Z(){return(Z=(0,a.Z)(p().mark((function e(t,n){var r,a,o,s,i,u;return p().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=v.C?localStorage.getItem("auth-token"):null,a=new P(b,r?{headers:{Authorization:"Bearer ".concat(r)}}:void 0),e.next=4,a.rawRequest(t,n);case 4:if(o=e.sent,s=o.data,i=o.headers,u=o.status,s){e.next=12;break}throw console.error(i),console.error(u),new Error("No data was received!");case 12:return e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function k(e){var t=e.headers.get("Content-Type");return t&&t.startsWith("application/json")?e.json():e.text()}t.ZP=function(e,t){return Z.apply(this,arguments)}},2957:function(e,t,n){n.d(t,{C:function(){return r}});var r=window.document&&window.document.createElement}}]);